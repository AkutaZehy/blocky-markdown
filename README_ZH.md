# Blocky Markdown 使用说明

一个极简主义的、无需框架的 Markdown 编辑器，提供块状编辑和层级文档导航功能。

## 主要功能

- 📑 **层级大纲** - 可折叠的标题结构，带级别缩进
- 📐 **可调整三列布局** - 大纲 | 工作区 | 缓存区
- 🎨 **双主题系统** - Daytime（日间）和 Nightcore（夜间）模式
- 📝 **块状编辑** - 11 种不同的块类型
- 📊 **增强表格编辑器** - 网格 + 专用单元格编辑器的分屏视图
- 🔗 **超链接编辑器** - 在段落、列表和表格中插入链接
- 💾 **导入/导出** - 完整的 Markdown 支持（含 frontmatter）
- 🔄 **自动保存** - 自动保存到 localStorage
- 🚀 **无需构建** - 纯 HTML、CSS 和 JavaScript

## 主题系统

### Daytime 主题（默认）
- 简洁的黑白设计
- 等宽字体，清晰易读
- 无装饰元素
- 专注写作体验

### Nightcore 主题（深色模式）
- 柔和的深色（#1A1A1A 背景）
- 护眼设计
- 良好的对比度
- 非纯黑色 - 更适合长时间使用

点击页眉的 ☀/🌙 按钮切换主题。

## 支持的块类型

所有块使用简洁的 HTML 风格标签（无 emoji）：

- `[frontmatter]` - Jekyll/Hugo YAML 前置数据
- `[p]` - 段落块
- `[h]` - 标题（H1-H6，带级别选择器）
- `[list]` - 有序或无序列表
- `[code]` - 带语言标签的代码块
- `[table]` - 交互式表格编辑器
- `[quote]` - 引用块
- `[hr]` - 水平分隔线
- `[br]` - 换行符
- `[html]` - 原始 HTML 块
- `[mermaid]` - Mermaid 图表支持

## 主要特性

### 层级大纲
- **显示文档结构** - 所有块都带图标列出
- **标题级别** - H1-H6 带适当缩进
- **可折叠节** - 点击 ▼/▶ 展开/折叠
- **快速导航** - 点击任意项跳转到对应块
- **自动更新** - 更改立即反映

### 可调整布局
- **三列设计** - 大纲 | 工作区 | 缓存区
- **拖动调整大小** - 竖线分隔符调整面板宽度
- **灵活尺寸** - 每个侧边栏：最小 150px，最大 500px
- **响应式** - 在移动设备上折叠为垂直布局

### 增强表格编辑器
- **分屏视图** - 网格（左）+ 内容编辑器（右）
- **添加/删除行列** - 动态操作不丢失数据
- **单元格选择** - 点击在专用文本区域中编辑
- **插入链接** - 单元格编辑器中的"插入链接"按钮
- **不丢失数据** - 所有操作都保留内容

### 超链接编辑器
- **可用于** - 段落、列表和表格单元格
- **"插入链接"按钮** - 打开专用模态框
- **字段** - 链接文本、URL 和可选标题
- **光标定位** - 在当前位置插入
- **Markdown 格式** - 生成正确的 `[text](url "title")` 语法

### 块管理
- **拖放** - 在工作区和缓存区之间移动块
- **箭头按钮** - ↑↓ 交换相邻块
- **缓存系统** - 将块移到缓存区而非删除
- **永久删除** - 仅在缓存区可用（需确认）
- **视觉反馈** - 边框高亮显示放置目标

## 使用方法

1. **打开编辑器**
   - 在浏览器中打开 `index.html`
   - 无需安装或构建过程

2. **选择主题**
   - 点击 ☀/🌙 按钮切换主题
   - 偏好自动保存

3. **添加块**
   - 使用工作区顶部的工具栏按钮
   - 标签显示块类型：[p]、[h]、[list] 等

4. **使用大纲**
   - 在左侧边栏查看文档结构
   - 点击 ▼/▶ 折叠/展开部分
   - 点击项目跳转到块

5. **调整面板大小**
   - 拖动列之间的竖线分隔符
   - 调整大纲、工作区和缓存区宽度

6. **插入链接**
   - 在段落或列表块中点击"插入链接"
   - 在表格单元格编辑器中使用"插入链接"
   - 填写文本、URL 和可选标题
   - 链接在光标位置插入

7. **管理块**
   - 拖动块以重新定位或移到缓存区
   - 使用 ↑↓ 按钮交换相邻块
   - "Cache"按钮移到缓存区
   - "Delete"（在缓存区）永久删除

8. **编辑表格**
   - 点击表格块上的"Edit"
   - 使用 +/- Row/Col 按钮
   - 选择单元格在右侧面板中编辑
   - 使用按钮在单元格中插入链接

9. **导入/导出**
   - 点击"↓ Import"粘贴 markdown
   - 点击"↑ Export"复制或下载
   - 支持 Jekyll frontmatter

## 使用技术

- **HTML5** - 结构
- **CSS3** - 带 CSS 变量的双主题
- **JavaScript (ES6+)** - 应用逻辑（1333 行）
- **Marked.js** - Markdown 解析（带备用方案）

## 浏览器兼容性

支持所有现代浏览器：
- ES6 JavaScript
- CSS Grid 和 Flexbox
- CSS 自定义属性
- LocalStorage API
- 拖放 API
- 鼠标事件（用于调整大小）

## 设计理念

**极简优先**：简洁的基于标签的 UI，无装饰性 emoji。专注内容，而非装饰。

**层级导航**：大型文档需要结构。可折叠大纲使导航轻松自如。

**灵活工作区**：可调整的面板让您自定义写作环境。

**无意外**：块移到缓存区而非立即删除。通过拖回来撤销。

## 已知缺陷（本地使用）

基于当前功能与实现，作为本地工作软件（不考虑持久化和内容安全）存在的主要缺陷：

1. **无撤销/历史记录**：所有操作直接改写 `workspaceBlocks`/`cacheBlocks` 并立即保存；导入时会清空现有块并重置计数器（`app.js#importMarkdown`），误操作后无法恢复。
2. **缺少 Markdown 渲染预览**：块预览在 `BlockRenderer.createPreviewElement` 仅截取原始文本，`marked` 库未用于实际渲染，无法确认列表、代码或 Mermaid 的最终呈现效果。
3. **导入/导出保真度有限**：`MarkdownUtils.parseImport` 依赖行级规则，不支持 setext 标题、`~~~` 代码围栏、对齐表格/嵌套列表等复杂结构；`exportBlocks` 仅拼接 `content` 字段，复杂 Markdown 往返易变形，frontmatter 也仅识别文件开头。
4. **触控/键盘可用性不足**：面板分隔与拖拽仅监听鼠标/HTML5 drag 事件（`setupResizer`、`DragDropManager`），触屏设备无法调整或重排；也未提供键盘操作替代。
5. **块编辑丢失格式细节**：表格编辑器用单行 `<input>` 重建并统一 `---` 分隔（`tableeditor.confirm`），无法保留对齐或单元格多行内容；代码块语言解析只匹配 `\w+`（`BlockFactory` 中的 `^```(\\w+)?`），`c#`、`c++` 等语言会被截断。

## 许可证

MIT License - 详见 LICENSE 文件

## 关于

为希望获得块状编辑和强大导航功能的作者设计的本地 Markdown 编辑器，界面简洁专业。无框架，无复杂性 - 打开即可开始写作。
